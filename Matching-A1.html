<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Random Multi-level Matching</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,system-ui,sans-serif; color:#333;}
body{background:#f8fafc;min-height:100vh;display:flex;flex-direction:column;justify-content: center;align-items:center;padding:20px}
.wrapper{position:relative;width:900px;display:flex;justify-content:center;gap:50px;margin-top:20px}
.column{width:40%}
.item{
    background:#f8fafc;
    border:2px solid #e2e8f0;
    border-radius:6px;
    padding:16px 12px;
    margin-bottom:12px;
    text-align:center;
    cursor:pointer;
    font-weight:600;
    font-size:1.2rem;
    position:relative;
    color:#333;
}
.item.used{opacity:.4;pointer-events:none}
.item.active{background:#e8f4fd;border-color:#538e9b}
@keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-5px)}50%{transform:translateX(5px)}75%{transform:translateX(-5px)}100%{transform:translateX(0)}}
.item.shake{animation:shake .4s}
svg{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}
#message{margin-top:20px;font-size:1.2rem;font-weight:600;color:#538e9b}
</style>
</head>
<body>

<h2>Random Multi-level Matching</h2>

<p style=font-size:1.2rem;font-weight:600;><br>Click on the word on the left and then click on its translation on the right. You will move <br> to the next level automatically.</p>

<div class="wrapper" id="wrapper">
<svg id="lines"></svg>
<div class="column" id="left"></div>
<div class="column" id="right"></div>
</div>

<div id="message"></div>

<script>
// Ð’ÑÐµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ñ‹
const allPairs = [
    {id:1, en:"wrinkles", ru:"Ð¼Ð¾Ñ€Ñ‰Ð¸Ð½Ñ‹"},
  {id:2, en:"costume", ru:"ÐºÐ¾ÑÑ‚ÑŽÐ¼"},
  {id:3, en:"calm", ru:"ÑÐ¿Ð¾ÐºÐ¾Ð¹Ð½Ñ‹Ð¹"},
  {id:4, en:"air conditioning", ru:"ÐºÐ¾Ð½Ð´Ð¸Ñ†Ð¸Ð¾Ð½ÐµÑ€"},
  {id:5, en:"remarried", ru:"Ð¶ÐµÐ½Ð¸Ð²ÑˆÐ¸Ð¹ÑÑ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾"},
  {id:6, en:"bored", ru:"ÑÐºÑƒÑ‡Ð°ÑŽÑ‰Ð¸Ð¹"},
  {id:7, en:"hotel", ru:"Ð¾Ñ‚ÐµÐ»ÑŒ, Ð³Ð¾ÑÑ‚Ð¸Ð½Ð¸Ñ†Ð°"},
  {id:8, en:"parking", ru:"Ð¿Ð°Ñ€ÐºÐ¾Ð²ÐºÐ°"},
  {id:9, en:"security guard", ru:"Ð¾Ñ…Ñ€Ð°Ð½Ð½Ð¸Ðº"},
  {id:10, en:"fur", ru:"Ð¼ÐµÑ…, ÑˆÐµÑ€ÑÑ‚ÑŒ"},
  {id:11, en:"slim", ru:"ÑÑ‚Ñ€Ð¾Ð¹Ð½Ñ‹Ð¹"},
  {id:12, en:"confident", ru:"ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ñ‹Ð¹"},
  {id:13, en:"disappointed", ru:"Ñ€Ð°Ð·Ð¾Ñ‡Ð°Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹"},
  {id:14, en:"depressed", ru:"Ð¿Ð¾Ð´Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹, Ð² Ð´ÐµÐ¿Ñ€ÐµÑÑÐ¸Ð¸"},
  {id:15, en:"credit card", ru:"ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ð°Ñ ÐºÐ°Ñ€Ñ‚Ð°"},
  {id:16, en:"divorced", ru:"Ð² Ñ€Ð°Ð·Ð²Ð¾Ð´Ðµ"},
  {id:17, en:"strangers", ru:"Ð½ÐµÐ·Ð½Ð°ÐºÐ¾Ð¼Ñ†Ñ‹"},
  {id:18, en:"sleepy", ru:"ÑÐ¾Ð½Ð½Ñ‹Ð¹"},
  {id:19, en:"stressed", ru:"Ð² ÑÑ‚Ñ€ÐµÑÑÐµ, Ð½Ð°Ð¿Ñ€ÑÐ¶ÐµÐ½Ð½Ñ‹Ð¹"},
  {id:20, en:"thirsty", ru:"Ð¸ÑÐ¿Ñ‹Ñ‚Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð¶Ð°Ð¶Ð´Ñƒ"},
  {id:21, en:"rest", ru:"Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº"},
  {id:22, en:"change", ru:"ÑÐ´Ð°Ñ‡Ð°, Ð¼ÐµÐ»Ð¾Ñ‡ÑŒ"},
  {id:23, en:"neighborhood", ru:"Ñ€Ð°Ð¹Ð¾Ð½, Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ"},
  {id:24, en:"flight", ru:"Ñ€ÐµÐ¹Ñ, Ð¿Ð¾Ð»Ñ‘Ñ‚"},
  {id:25, en:"gate", ru:"Ð²Ñ‹Ñ…Ð¾Ð´ (Ð² Ð°ÑÑ€Ð¾Ð¿Ð¾Ñ€Ñ‚Ñƒ)"},
  {id:26, en:"seat", ru:"Ð¼ÐµÑÑ‚Ð¾ (ÑÐ¸Ð´ÑÑ‡ÐµÐµ)"},
  {id:27, en:"bother", ru:"Ñ‚Ñ€ÐµÐ²Ð¾Ð¶Ð¸Ñ‚ÑŒ, Ð¼ÐµÑˆÐ°Ñ‚ÑŒ"},
  {id:28, en:"neck", ru:"ÑˆÐµÑ"},
  {id:29, en:"insects", ru:"Ð½Ð°ÑÐµÐºÐ¾Ð¼Ñ‹Ðµ"},
  {id:30, en:"touch", ru:"Ñ‚Ñ€Ð¾Ð³Ð°Ñ‚ÑŒ, Ð¿Ñ€Ð¸ÐºÐ°ÑÐ°Ñ‚ÑŒÑÑ"},
  {id:31, en:"both", ru:"Ð¾Ð±Ð°"},
  {id:32, en:"chef", ru:"ÑˆÐµÑ„-Ð¿Ð¾Ð²Ð°Ñ€"},
  {id:33, en:"subway", ru:"Ð¼ÐµÑ‚Ñ€Ð¾"},
  {id:34, en:"relax", ru:"Ñ€Ð°ÑÑÐ»Ð°Ð±Ð»ÑÑ‚ÑŒÑÑ"},
  {id:35, en:"beard", ru:"Ð±Ð¾Ñ€Ð¾Ð´Ð°"},
  {id:36, en:"expensive", ru:"Ð´Ð¾Ñ€Ð¾Ð³Ð¾Ð¹"},
  {id:37, en:"routine", ru:"Ñ€Ð°ÑÐ¿Ð¾Ñ€ÑÐ´Ð¾Ðº Ð´Ð½Ñ"},
  {id:38, en:"role", ru:"Ñ€Ð¾Ð»ÑŒ"},
  {id:39, en:"crowded", ru:"Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ð¹ Ð»ÑŽÐ´ÑŒÐ¼Ð¸"},
  {id:40, en:"peaceful", ru:"Ñ‚Ð¸Ñ…Ð¸Ð¹, ÑÐ¿Ð¾ÐºÐ¾Ð¹Ð½Ñ‹Ð¹"},
  {id:41, en:"truth", ru:"Ð¿Ñ€Ð°Ð²Ð´Ð°"},
  {id:42, en:"lie", ru:"Ð»Ð¾Ð¶ÑŒ"},
  {id:43, en:"tough", ru:"Ñ‚ÑÐ¶Ñ‘Ð»Ñ‹Ð¹, Ñ‚Ñ€ÑƒÐ´Ð½Ñ‹Ð¹"},
  {id:44, en:"groceries", ru:"Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ (Ð¿Ð¸Ñ‚Ð°Ð½Ð¸Ñ)"},
  {id:45, en:"depends", ru:"Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚"},
  {id:46, en:"qualifications", ru:"ÐºÐ²Ð°Ð»Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ, Ð½Ð°Ð²Ñ‹ÐºÐ¸"},
  {id:47, en:"earn", ru:"Ð·Ð°Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ"},
  {id:48, en:"lazy", ru:"Ð»ÐµÐ½Ð¸Ð²Ñ‹Ð¹"},
  {id:49, en:"talkative", ru:"Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ñ‡Ð¸Ð²Ñ‹Ð¹"},
  {id:50, en:"loud", ru:"Ð³Ñ€Ð¾Ð¼ÐºÐ¸Ð¹"},
  {id:51, en:"factory", ru:"Ñ„Ð°Ð±Ñ€Ð¸ÐºÐ°, Ð·Ð°Ð²Ð¾Ð´"},
  {id:52, en:"niece", ru:"Ð¿Ð»ÐµÐ¼ÑÐ½Ð½Ð¸Ñ†Ð°"},
  {id:53, en:"cost", ru:"ÑÑ‚Ð¾Ð¸Ñ‚ÑŒ"},
  {id:54, en:"library", ru:"Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ°"},
  {id:55, en:"nephew", ru:"Ð¿Ð»ÐµÐ¼ÑÐ½Ð½Ð¸Ðº"},
  {id:56, en:"builder", ru:"ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÐµÐ»ÑŒ"},
  {id:57, en:"requirements", ru:"Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ"},
  {id:58, en:"listen", ru:"ÑÐ»ÑƒÑˆÐ°Ñ‚ÑŒ"},
  {id:59, en:"watch", ru:"ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ (Ð¢Ð’, Ñ„Ð¸Ð»ÑŒÐ¼)"},
  {id:60, en:"once a week", ru:"Ñ€Ð°Ð· Ð² Ð½ÐµÐ´ÐµÐ»ÑŽ"},
  {id:61, en:"every month", ru:"ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð¼ÐµÑÑÑ†"},
  {id:62, en:"weekends", ru:"Ð²Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ðµ"},
  {id:63, en:"once a year", ru:"Ñ€Ð°Ð· Ð² Ð³Ð¾Ð´"},
  {id:64, en:"vacation", ru:"Ð¾Ñ‚Ð¿ÑƒÑÐº, ÐºÐ°Ð½Ð¸ÐºÑƒÐ»Ñ‹"},
  {id:65, en:"keys", ru:"ÐºÐ»ÑŽÑ‡Ð¸"},
  {id:66, en:"diary", ru:"Ð´Ð½ÐµÐ²Ð½Ð¸Ðº (Ð·Ð°Ð¿Ð¸ÑÐ¸)"},
  {id:67, en:"passport", ru:"Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚"},
  {id:68, en:"purse", ru:"ÐºÐ¾ÑˆÐµÐ»ÐµÐº, ÑÑƒÐ¼Ð¾Ñ‡ÐºÐ° (Ð¶ÐµÐ½ÑÐºÐ°Ñ)"},
  {id:69, en:"ticket", ru:"Ð±Ð¸Ð»ÐµÑ‚"},
  {id:70, en:"shampoo", ru:"ÑˆÐ°Ð¼Ð¿ÑƒÐ½ÑŒ"},
  {id:71, en:"earphones", ru:"Ð½Ð°ÑƒÑˆÐ½Ð¸ÐºÐ¸ (Ð²ÑÑ‚Ð°Ð²Ð½Ñ‹Ðµ)"},
  {id:72, en:"procrastinate", ru:"Ð¿Ñ€Ð¾ÐºÑ€Ð°ÑÑ‚Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"},
  {id:73, en:"map", ru:"ÐºÐ°Ñ€Ñ‚Ð°"},
  {id:74, en:"sofa", ru:"Ð´Ð¸Ð²Ð°Ð½"},
  {id:75, en:"babysitter", ru:"Ð½ÑÐ½Ñ"},
  {id:76, en:"printer", ru:"Ð¿Ñ€Ð¸Ð½Ñ‚ÐµÑ€"},
  {id:77, en:"tissues", ru:"ÑÐ°Ð»Ñ„ÐµÑ‚ÐºÐ¸ (Ð±ÑƒÐ¼Ð°Ð¶Ð½Ñ‹Ðµ)"},
  {id:78, en:"wipes", ru:"Ð²Ð»Ð°Ð¶Ð½Ñ‹Ðµ ÑÐ°Ð»Ñ„ÐµÑ‚ÐºÐ¸"},
  {id:79, en:"neat", ru:"Ð¾Ð¿Ñ€ÑÑ‚Ð½Ñ‹Ð¹, Ð°ÐºÐºÑƒÑ€Ð°Ñ‚Ð½Ñ‹Ð¹"},
  {id:80, en:"messy", ru:"Ð½ÐµÐ¿Ñ€Ð¸Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹"},
  {id:81, en:"wallet", ru:"ÐºÐ¾ÑˆÐµÐ»ÐµÐº (Ð¼ÑƒÐ¶ÑÐºÐ¾Ð¹)"},
  {id:82, en:"change purse", ru:"ÐºÐ¾ÑˆÐµÐ»ÐµÐº Ð´Ð»Ñ Ð¼Ð¾Ð½ÐµÑ‚"},
  {id:83, en:"charger", ru:"Ð·Ð°Ñ€ÑÐ´Ð½Ð¾Ðµ ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾"},
  {id:84, en:"safe", ru:"Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹"},
  {id:85, en:"dangerous", ru:"Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹"},
  {id:86, en:"dirty", ru:"Ð³Ñ€ÑÐ·Ð½Ñ‹Ð¹"},
  {id:87, en:"empty", ru:"Ð¿ÑƒÑÑ‚Ð¾Ð¹"},
  {id:88, en:"weak", ru:"ÑÐ»Ð°Ð±Ñ‹Ð¹"},
  {id:89, en:"sibling", ru:"Ð±Ñ€Ð°Ñ‚ Ð¸Ð»Ð¸ ÑÐµÑÑ‚Ñ€Ð°"},
  {id:90, en:"appearance", ru:"Ð²Ð½ÐµÑˆÐ½Ð¾ÑÑ‚ÑŒ"}
];
let selected=null, currentLevel=0, correctCount=0;
const levelsCount=15, pairsPerLevel=6;

function initLevel(){
    left.innerHTML=""; right.innerHTML=""; lines.innerHTML="";
    correctCount=0;
    message.textContent=`Level ${currentLevel+1} of ${levelsCount}`;

    // Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ñ‹ Ð´Ð»Ñ ÑƒÑ€Ð¾Ð²Ð½Ñ
    const shuffled = [...allPairs].sort(()=>Math.random()-0.5);
    const levelPairs = shuffled.slice(0,pairsPerLevel);

    // ÑÐ¾Ð·Ð´Ð°ÐµÐ¼ Ð±Ð»Ð¾ÐºÐ¸
    shuffle(levelPairs).forEach(p=>left.appendChild(createItem(p.en,p.id,"left")));
    shuffle(levelPairs).forEach(p=>right.appendChild(createItem(p.ru,p.id,"right")));
}

function createItem(text,id,side){
    const d=document.createElement("div");
    d.className="item "+side;
    d.dataset.id=id;
    d.dataset.side=side;
    d.textContent=text;
    d.addEventListener("click",()=>selectItem(d));
    return d;
}

function anchor(el){
    const r=el.getBoundingClientRect();
    const w=wrapper.getBoundingClientRect();
    return el.dataset.side==="left"
        ? {x:r.right-w.left,y:r.top+r.height/2-w.top}
        : {x:r.left-w.left,y:r.top+r.height/2-w.top};
}

function selectItem(el){
    if(el.classList.contains("used"))return;

    if(!selected){
        selected=el;
        el.classList.add("active");
        return;
    }

    if(selected.dataset.side===el.dataset.side){
        selected.classList.remove("active");
        selected=el;
        el.classList.add("active");
        return;
    }

    const p1=anchor(selected),p2=anchor(el);
    const line=document.createElementNS("http://www.w3.org/2000/svg","line");
    line.setAttribute("x1",p1.x); line.setAttribute("y1",p1.y);
    line.setAttribute("x2",p2.x); line.setAttribute("y2",p2.y);
    line.setAttribute("stroke-width","2");
    lines.appendChild(line);

    if(selected.dataset.id===el.dataset.id){
        line.setAttribute("stroke","#4fa46b");
        selected.classList.add("used");
        el.classList.add("used");
        correctCount++;
        if(correctCount===pairsPerLevel){
            setTimeout(nextLevel,500);
        }
    }else{
        line.setAttribute("stroke","#c05b6d");
        selected.classList.add("shake");
        el.classList.add("shake");
        setTimeout(()=>{
            line.remove();
            selected.classList.remove("shake");
            el.classList.remove("shake");
        },400);
    }

    selected.classList.remove("active");
    selected=null;
}

function nextLevel(){
    currentLevel++;
    if(currentLevel<levelsCount){
        initLevel();
    }else{
        left.innerHTML=""; right.innerHTML=""; lines.innerHTML="";
        message.textContent="ðŸŽ‰ Congratulations! You completed all levels!";
    }
}

function shuffle(a){return [...a].sort(()=>Math.random()-0.5)}

initLevel();
</script>
</body>
</html>
